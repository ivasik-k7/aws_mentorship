# AWS WAF (Web Application Firewall)

## Вступ

AWS WAF (Web Application Firewall) - це веб-екран безпеки, який допомагає захистити веб-додатки від поширених атак, таких як SQL-ін'єкції, міжсайтовий скриптинг (XSS) та атаки на відмову в обслуговуванні (DDoS). AWS WAF дозволяє створювати правила для фільтрації HTTP/HTTPS-трафіку на основі певних умов.

## Основні компоненти AWS WAF

### 1. **WebACL (Web Access Control List)**

WebACL є основною сутністю, яка містить набір правил (Rules) для перевірки трафіку. WebACL можна асоціювати з такими сервісами:

- Application Load Balancer (ALB)
- Amazon API Gateway
- AWS AppSync
- Amazon CloudFront

### 2. **Rules (Правила)**

Правила визначають критерії, за якими AWS WAF перевіряє HTTP/HTTPS-запити. Основні типи правил:

- **Rate-based rules** – обмежують кількість запитів з одного джерела за певний період.
- **Managed rules** – попередньо налаштовані правила від AWS або партнерів AWS Marketplace (наприклад, AWS WAF OWASP Top 10).
- **IP Set rules** – дозволяють блокувати або дозволяти запити з певних IP-адрес або підмереж.
- **String match rules** – блокують або дозволяють запити, які містять певні ключові слова або шаблони.
- **Regex match rules** – використовують регулярні вирази для перевірки запитів.

## Основні сценарії використання

### 1. **Розгортання WAF з Application Load Balancer (ALB)**

WAF може бути прикріплений до ALB для захисту веб-додатків від загроз. Основні сценарії:

- Блокування трафіку з підозрілих IP-адрес
- Захист від ботів
- Використання rate-based правил для запобігання DDoS-атакам

### 2. **Розгортання WAF з CloudFront**

CloudFront дозволяє використовувати WAF для глобального розгортання захисту. Сценарії:

- Захист статичного контенту та API від атак
- Використання геоблокування для обмеження доступу
- Використання кешування для покращення продуктивності

## Впровадження OWASP Protections

AWS пропонує набір керованих правил для захисту від найбільш поширених атак OWASP:

- **AWS Managed Rules - SQL Injection** – захищає від SQL-ін'єкцій.
- **AWS Managed Rules - Cross-Site Scripting (XSS)** – захищає від XSS-атак.
- **AWS Managed Rules - Common Rule Set** – включає загальні правила безпеки для захисту веб-додатків.

## Аналіз логів та моніторинг

AWS WAF інтегрується з **CloudWatch Logs**, що дозволяє аналізувати журнали запитів і відстежувати потенційні загрози. Метрики можна використовувати для виявлення аномального трафіку та автоматичного реагування на загрози.

## Тестування Rate-Limiting та Geo-blocking

- **Rate-limiting** – обмеження запитів з одного джерела (наприклад, не більше 1000 запитів за 5 хвилин).
- **Geo-blocking** – обмеження трафіку з певних країн (наприклад, блокування запитів з країн з високим рівнем атак).
